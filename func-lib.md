1# 创建和使用函数库

函数库可以分为两种：

* 静态库
* 共享库

## 静态库

静态库由ar工具创建。经编译的应用程序和静态库链接时，连接器将静态库中被调用的对象嵌入至可执行文件中，这样在没有静态库的环境下，应用程序也能独立运行。静态库文件的命名规则是libxxx.a， 以lib开头，.a作为文件名后缀

### 1.静态库管理工具

ar 命令

语法：  
```bash
ar [选项] [归档文件] 目标文件列表
```

功能：  
创建、修改、查询归档文件  

### 2.创建静态库

编译：  
gcc -c a.c  
gcc -c b.c  

创建静态库：  
ar -cru libxxx.a a.o b.o

### 3. 静态库的使用

gcc use-static-lib.c -L. -lxxx -o use-static-lib

* -L. 表示静态库在当前目录下
* -lxxx 表示libxxx.a归档文件 省略了前缀lib和后缀.a

## 共享库

根据使用共享库的方式不同，共享库也成为动态加载库。经过编译后的应用程序在和共享库链接时，链接器在库中检查所需的符号信息，例如函数和变量，只在生成的可执行映像文件中记录这些信息的来源。与静态库不同，没有将共享库中的目标对象嵌入至映像文件。因此离开共享库的支持应用程序无法运行。共享库文件的命名规则是libxxx.so，以lib开始，.so作为后缀。

### 1.创建共享库

gcc -fPIC -c a.c  
gcc -fPIC -c b.c  
gcc -shared a.o b.o -o libxxx.so  

* -fPIC 创建地址独立的目标文件
* -shared 创建一个共享库

### 2.使用共享库
gcc use-static-lib.c -o use-shared-lib ./libdemo.so


